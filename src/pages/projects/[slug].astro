---
import { getCollection } from "astro:content";
import BaseLayout from "@components/base/BaseLayout.astro";
import type { Product, Store } from "@/markket";
import ProductPage from "@/components/projects/projectPage";

const { slug } = Astro.params;
const product = (await getCollection("products"))?.find(
  (p) => p?.data?.slug === slug
)?.data as unknown as Product;

const store = (await getCollection("store"))?.[0]?.data as unknown as Store;

export async function getStaticPaths() {
  const products = await getCollection("products");
  return products.map((product) => ({
    params: { slug: product.data.slug },
    props: {},
  }));
}
---

<BaseLayout>
  <section class="max-w-[1200px] mx-auto py-12">
    <div class="container mx-auto">
      <div class="mx-auto rounded-2xl bg-white/80 shadow-xl p-8">
        <div class="flex flex-col items-center mb-8">
          <ProductPage client:load product={product} store={store} />
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
